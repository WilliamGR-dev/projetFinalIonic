<template>
  <section style="height: 100vh;width: 100%;" class="d-flex flex-wrap">
    <section style="height: 100vh;width: 100%" class="">
      <div class="h-100 p-4">
        <div class="h-100 scroll">
          <hr>
          <h3 class="text-white" style="margin-top: 20px">Informations Clients</h3>
          <div class="d-flex flex-column w-100">
            <div class="w-100">
              <h3>Youzik autorisation</h3>
              <div class="rounded-1 bg-light p-5 text-dark w-100">
                Enura Indula<br>
                371/C, Kapuwatta Rd,<br>
                Kandana,<br>
                Sri Lanka.<br>
                Tel:  0765464362<br>
              </div>
            </div>
            <div class="w-100"  >
              <h4 class="w-100">Termes et conditions</h4>
              <div class="w-100 scroll" style="overflow-y: scroll;height: 400px">
                Bienvenue sur le site Web YouZik!

                Ces termes et conditions dÃ©crivent les rÃ¨gles et rÃ©glementations relatives Ã  l'utilisation du site Web de YouZik, situÃ© Ã  youzik.com.

                En accÃ©dant Ã  ce site Web, nous supposons que vous acceptez ces termes et conditions. Ne continuez pas Ã  utiliser le site Web YouZik si vous n'acceptez pas toutes les conditions gÃ©nÃ©rales Ã©noncÃ©es sur cette page.

                La terminologie suivante s'applique aux prÃ©sentes conditions gÃ©nÃ©rales, Ã  la dÃ©claration de confidentialitÃ© et Ã  l'avis de non-responsabilitÃ© et Ã  tous les accords: Â«ClientÂ», Â«VousÂ» et Â«VotreÂ» font rÃ©fÃ©rence Ã  vous, la personne connectÃ©e Ã  ce site Web et conforme aux conditions gÃ©nÃ©rales de la sociÃ©tÃ©. Â«L'entrepriseÂ», Â«nous-mÃªmesÂ», Â«nousÂ», Â«notreÂ» et Â«nousÂ» dÃ©signent notre entreprise. Â«PartieÂ», Â«PartiesÂ» ou Â«NousÂ» dÃ©signe Ã  la fois le Client et nous-mÃªmes. Toutes les conditions font rÃ©fÃ©rence Ã  l'offre, Ã  l'acceptation et Ã  la prise en compte du paiement nÃ©cessaires pour entreprendre le processus de notre assistance au client de la maniÃ¨re la plus appropriÃ©e dans le but exprÃ¨s de rÃ©pondre aux besoins du client en ce qui concerne la fourniture des services dÃ©clarÃ©s de la sociÃ©tÃ©, conformÃ©ment Ã  et sous rÃ©serve de la loi en vigueur aux Pays-Bas. Toute utilisation de la terminologie ci-dessus ou d'autres mots au singulier, au pluriel, en majuscules et / ou il / elle ou eux, sont considÃ©rÃ©s comme interchangeables et donc comme faisant rÃ©fÃ©rence Ã  ceux-ci.

                Biscuits
                Nous utilisons des cookies. En accÃ©dant au site Web YouZik, vous avez acceptÃ© d'utiliser des cookies en accord avec la politique de confidentialitÃ© de YouZik.

                La plupart des sites Web interactifs utilisent des cookies pour nous permettre de rÃ©cupÃ©rer les dÃ©tails de l'utilisateur Ã  chaque visite. Les cookies sont utilisÃ©s par notre site Web pour activer la fonctionnalitÃ© de certaines zones afin de faciliter la visite des personnes visitant notre site Web. Certains de nos affiliÃ©s / partenaires publicitaires peuvent Ã©galement utiliser des cookies.

                Licence
                Sauf indication contraire, YouZik et / ou ses concÃ©dants de licence dÃ©tiennent les droits de propriÃ©tÃ© intellectuelle pour tout le matÃ©riel sur le site Web YouZik. Tous les droits de propriÃ©tÃ© intellectuelle sont rÃ©servÃ©s. Vous pouvez y accÃ©der Ã  partir du site Web YouZik pour votre usage personnel, sous rÃ©serve des restrictions dÃ©finies dans les prÃ©sentes conditions gÃ©nÃ©rales.

                Il ne faut pas:

                Republier le matÃ©riel du site Web YouZik
                Vendre, louer ou sous-licencier du matÃ©riel du site Web YouZik
                Reproduire, dupliquer ou copier du matÃ©riel du site Web YouZik
                Redistribuer le contenu du site Web YouZik
                Le prÃ©sent accord commencera Ã  la date des prÃ©sentes.

                Certaines parties de ce site Web offrent aux utilisateurs la possibilitÃ© de publier et d'Ã©changer des opinions et des informations dans certaines zones du site Web. YouZik ne filtre pas, ne modifie pas, ne publie pas et ne rÃ©vise pas les commentaires avant leur prÃ©sence sur le site Web. Les commentaires ne reflÃ¨tent pas les points de vue et les opinions de YouZik, de ses agents et / ou affiliÃ©s. Les commentaires reflÃ¨tent les points de vue et les opinions de la personne qui publie ses points de vue et opinions. Dans la mesure permise par les lois applicables, YouZik ne sera pas responsable des commentaires ou de toute responsabilitÃ©, dommages ou dÃ©penses causÃ©s et / ou subis Ã  la suite de toute utilisation et / ou publication et / ou apparition des commentaires sur ce site Internet.

                YouZik se rÃ©serve le droit de surveiller tous les commentaires et de supprimer tout commentaire qui peut Ãªtre considÃ©rÃ© comme inappropriÃ©, offensant ou qui entraÃ®ne une violation des prÃ©sentes conditions gÃ©nÃ©rales.

                Vous garantissez et dÃ©clarez que:

                Vous avez le droit de publier les commentaires sur notre site Web et de disposer de toutes les licences et consentements nÃ©cessaires pour le faire;
                Les Commentaires n'envahissent aucun droit de propriÃ©tÃ© intellectuelle, y compris, sans limitation, les droits d'auteur, brevets ou marques de commerce d'un tiers;
                Les commentaires ne contiennent aucun matÃ©riel diffamatoire, calomnieux, offensant, indÃ©cent ou autrement illÃ©gal qui constitue une atteinte Ã  la vie privÃ©e
                Les commentaires ne seront pas utilisÃ©s pour solliciter ou promouvoir des activitÃ©s commerciales ou personnalisÃ©es ou prÃ©senter des activitÃ©s commerciales ou des activitÃ©s illÃ©gales.
                Vous accordez par la prÃ©sente Ã  YouZik une licence non exclusive pour utiliser, reproduire, Ã©diter et autoriser d'autres personnes Ã  utiliser, reproduire et Ã©diter l'un de vos commentaires sous tous les formats, formats ou supports.

                Hyperliens vers notre contenu
                Les organisations suivantes peuvent crÃ©er un lien vers notre site Web sans autorisation Ã©crite prÃ©alable:

                Organismes gouvernementaux;
                Moteurs de recherche;
                Organisations de presse;
                Les distributeurs d'annuaires en ligne peuvent crÃ©er un lien vers notre site Web de la mÃªme maniÃ¨re qu'ils crÃ©ent un lien hypertexte vers les sites Web d'autres entreprises cotÃ©es; et
                Entreprises accrÃ©ditÃ©es Ã  l'Ã©chelle du systÃ¨me, Ã  l'exception de la sollicitation d'organisations Ã  but non lucratif, de centres commerciaux caritatifs et de groupes de collecte de fonds caritatifs qui ne peuvent pas crÃ©er de lien hypertexte vers notre site Web.
                Ces organisations peuvent crÃ©er un lien vers notre page d'accueil, vers des publications ou vers d'autres informations sur le site Web Ã  condition que le lien: (a) ne soit en aucun cas trompeur; (b) n'implique pas Ã  tort un parrainage, une approbation ou une approbation de la partie liante et de ses produits et / ou services; et (c) s'inscrit dans le contexte du site de la partie liante.
              </div>
            </div>
            <div class="w-100 mt-3 mb-3 d-flex flex-column"  >
                <label class="label">CODE PROMO</label>
                <input type="text" class="form_control text-dark" placeholder="Entrer le code promo" v-model="form.promo">
            </div>
              <div id="card-element"></div>
            <div v-if="planId == 'price_1J2H1vGsegk9YRQoKXhtXvqW'" class="w-100">
              <div class="rounded-1 bg-light p-5 text-dark w-75 d-flex flex-column align-items-center mt-4">
                <h3 class="m-3">PERSONNEL</h3>
                <h3 class="m-3">4,99â‚¬/mois</h3>
              </div>
              <div class="w-100 d-flex justify-content-between mt-5">
                <div>Panier</div>
                <div>4,99â‚¬</div>
              </div>
              <div class="w-100 d-flex justify-content-between mt-5">
                <div>Total</div>
                <div>4,99â‚¬</div>
              </div>
            </div>
            <div v-if="planId == 'price_1J2H2ZGsegk9YRQooblJfbxa'" class="w-100">
              <div class="rounded-1 bg-light p-5 text-dark w-75 d-flex flex-column align-items-center mt-4">
                <h3 class="m-3">Famille</h3>
                <h3 class="m-3">9,99â‚¬/mois</h3>
              </div>
              <div class="w-100 d-flex justify-content-between mt-5">
                <div>Panier</div>
                <div>9,99â‚¬</div>
              </div>
              <div class="w-100 d-flex justify-content-between mt-5">
                <div>Total</div>
                <div>9,99â‚¬</div>
              </div>
            </div>
          </div>
          <button class="btn btn-outline-light mt-4">Annuler</button>
          <button class="btn btn-outline-light mt-4" style="margin-left: 50px" @click.prevent="submit">Payer Maintenant</button>
        </div>
      </div>
    </section>
  </section>
</template>


<script>
import {
    toastController,
} from "@ionic/vue";
import {mapActions, mapGetters} from 'vuex'
import axios from "axios";

export default {
    name: "Cgu",
    data() {
        return {
            secret: null,
            stripe: null,
            payment_method: null,
            requires_action: null,
            payment_intent: null,
            card: null,
            payment_processed: false,
            message_processed: "",
            form: {

            }
        };
    },
    computed: {
        ...mapGetters(['planId']),
        ...mapGetters(['user']),
    },
    methods: {
        ...mapActions(['sessionUpdate']),
        async submit() {
            this.payment_processing = true;
            const { setupIntent, error } = await this.stripe.confirmCardSetup(
                this.secret,
                {
                    payment_method: {
                        card: this.card,
                        billing_details: { name: this.name },
                    },
                }
            );
            if (error) {
                console.log(error);
                const toast = await toastController.create({
                    message: error.message,
                    duration: 2000,
                    color: "danger",
                });
                return toast.present();
            } else {
                console.log(setupIntent);
                this.payment_method = setupIntent.payment_method;
                await axios
                    .post(
                        `${process.env.VUE_APP_API_URL}/stripe/subscribe`,
                        {
                            id: this.user.data.id,
                            plan: this.planId,
                            name: this.user.data.name,
                            payment_method: this.payment_method,
                            coupon: this.form.promo,
                        },
                        {
                            headers: {
                                Authorization: `Bearer ${this.token}`,
                            },
                        }
                    )
                    .then((response) => {
                        console.log(response.data);
                        if (
                            response.data.status &&
                            response.data.status == "requires_action"
                        ) {
                            // Confirmation
                            this.$emit('paymentMethod', this.payment_method)
                            this.$emit('requiresAction', true)
                            this.$emit('paymentIntent', response.data)
                        } else {
                            this.sessionUpdate();
                            this.$emit('paymentProcessed', true);
                            this.$emit('messageProcessed', "Merci de votre abonnement ! ğŸ¤‘");
                        }
                    })
                    .catch((error) => {
                        console.log(error);
                    });
            }
        },
    },
    components: {

    },
    mounted(){
        this.stripe = window.Stripe(process.env.VUE_APP_STRIPE_PUBLIC_KEY);
        const elements = this.stripe.elements();
        this.card = elements.create("card");
        this.card.mount("#card-element");

        axios.post(
            `${process.env.VUE_APP_API_URL}/stripe/intent`,
            {
                id: this.user.data.id,
            },
            {
                headers: {
                    Authorization: `Bearer ${this.token}`,
                },
            }
        )
            .then((response) => {
                this.secret = response.data.client_secret;
            })
            .catch((error) => {
                console.log(error);
            });

    }

}
</script>

<style scoped>
#container {
  text-align: center;

  position: absolute;
  left: 0;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
}

#container strong {
  font-size: 20px;
  line-height: 26px;
}

#container p {
  font-size: 16px;
  line-height: 22px;

  color: #8c8c8c;

  margin: 0;
}

#container a {
  text-decoration: none;
}
</style>
